# Licensed under the MIT License - see LICENSE.txt
""" Miscellaneous regex patterns """
import re


__all__ = [
    "PTN_LIBC_CTIME",
    "PTN_SNMP_MIB",
    "PTN_MAC_ADDR",
    "PTN_IP_V4",
    "PTN_IP_V6",
]

PTN_LIBC_CTIME = re.compile(
    # The libc ctime format
    r'(Mon|Tue|Wed|Thu|Fri|Sat|Sun) '
    r'(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) '
    r'(([0-2]\d)|(3[0-1])) '
    r'(([01]\d|2[0-3]):([0-5]\d):([0-5]\d)|24:00:00) \d{4}'
)

PTN_SNMP_MIB = re.compile(
    # SNMP MIB OID
    r'([0-9]+\.){4,20}[0-9]+'
)

PTN_MAC_ADDR = re.compile(
    r'([A-Fa-f0-9]+\:){5}[A-Fa-f0-9]+'
)

PTN_IP_V4 = re.compile(
    r'(/|)([0-9]+\.){3}[0-9]+(:[0-9]+|)(:|)'
)

PTN_IP_V6 = re.compile(
    # IPv6 Address from https://gist.github.com/mnordhoff/2213179
    # A more elegant rex can be found at
    # https://gist.github.com/dfee/6ed3a4b05cfe7a6faf40a2102408d5d8
    r' (?:(?:[0-9A-Fa-f]{1,4}:){6}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}'
    r'|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]'
    r'|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))'
    r'|::(?:[0-9A-Fa-f]{1,4}:){5}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}'
    r'|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]'
    r'|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))'
    r'|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}'
    r'(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}'
    r'|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]'
    r'|25[0-5]))|(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]'
    r'{1,4}:){3}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]'
    r'|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}'
    r'|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:){,2}[0-9A-Fa-f]'
    r'{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}'
    r'|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]'
    r'|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:(?:[0-9A-Fa-f]{1,4}:)'
    r'{,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:(?:[0-9A-Fa-f]{1,4}:'
    r'[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]'
    r'|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))'
    r'|(?:(?:[0-9A-Fa-f]{1,4}:){,4}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]'
    r'{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]'
    r'|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))'
    r'|(?:(?:[0-9A-Fa-f]{1,4}:){,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}'
    r'|(?:(?:[0-9A-Fa-f]{1,4}:){,6}[0-9A-Fa-f]{1,4})?::)(/\d{1,3})?'
)
